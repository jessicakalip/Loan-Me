<div class="banner">
  <div class="container m-5 p-5 ">
    <h1>Hangout Details</h1>
  </div>
</div>

<div class="container">

  <div class="row">
    <% if current_user == @hangout.user %>
    <h5>You are hanging out with:</h5>
    <%= @hangout.profile.name %>
    <% else %>
    <h5>Your request from:</h5>
    <%= @hangout.user.email %>
    <% end %>
    <h5>Hangout status</h5>
    <%= @hangout.status %>
    <h5>Hangout details</h5>
    <%= @hangout.date.strftime("%b %d, %Y") %>
    <%= @hangout.time.strftime("%I:%M %p") %>
    <% if @hangout.review && @hangout.review.persisted? %>
      <h5>Hangout Review</h5>
      <%= @hangout.review.rating %>
      <%= @hangout.review.comment %>
    <% elsif policy(@review).create? %>
      <%= simple_form_for [@hangout, @review] do |f| %>
        <%= f.input :comment %>
        <%= f.input :rating, collection: 1..5 %>
        <%= f.submit %>
      <% end %>
    <% end %>
   </div>

  <div class="py-4">
    <%# Update and complete button %>
    <% if policy(@hangout).update? && current_user == @hangout.user %>
      <%= link_to 'Edit', edit_hangout_path(@hangout), class: "btn btn-primary" %>
      <% if @hangout.status != "pending" %>
        <%= link_to 'Complete',
                      hangout_path(@hangout, hangout: {status: "completed"}),
                      method: :patch, class: "btn btn-info",
                      data: { confirm: "Are you sure?" }%>
      <% end %>
    <% end %>
    <%# Delete button %>
    <% if policy(@hangout).destroy? %>
      <%= link_to "Delete",
                      hangout_path(@hangout),
                      class: "btn btn-warning",
                      method: :delete,
                      data: { confirm: "Are you sure?" } %>
    <% end %>
    <%# Accept and Reject button %>
    <% if current_user.profile == @hangout.profile && @hangout.status == "pending" %>
      <%= link_to 'Accept',
                      hangout_path(@hangout, hangout: {status: "accepted"}),
                      method: :patch, class: "btn btn-success" %>
      <%= link_to 'Reject',
                      hangout_path(@hangout, hangout: {status: "rejected"}),
                      method: :patch, class: "btn btn-danger" %>
    <% end %>
      <%= link_to 'Back', dashboard_path, class: "btn btn-info" %>
  </div>
</div>
